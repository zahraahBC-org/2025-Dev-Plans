# TAB 5: Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¶ | Presentation Layer

## 5. Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¶ | Presentation Layer
### ØªØ·Ø¨ÙŠÙ‚ Ø·Ø¨Ù‚Ø© Ø¹Ø±Ø¶ Ù†Ø¸ÙŠÙØ© Ù…Ø¹ ØªÙ†Ù‚Ù„ Ù…Ù†Ø§Ø³Ø¨ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© ÙˆÙ…ÙƒÙˆÙ†Ø§Øª UI

---

## ğŸ¯ **Ø§Ù„Ù‡Ø¯Ù | Objective**
ØªØ·Ø¨ÙŠÙ‚ Ø·Ø¨Ù‚Ø© Ø¹Ø±Ø¶ Ù†Ø¸ÙŠÙØ© Ù…Ø¹ ØªÙ†Ù‚Ù„ Ù…Ù†Ø§Ø³Ø¨ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© ÙˆÙ…ÙƒÙˆÙ†Ø§Øª UI ØªØªØ¨Ø¹ Ù…Ø¨Ø§Ø¯Ø¦ Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„Ù†Ø¸ÙŠÙØ©.

## ğŸ“‹ **Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© | Rule**
**Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©**: Ø§Ø³ØªØ®Ø¯Ù… go_router Ù…Ø¹ Guards Ù„Ù„Ø·Ø±Ù‚ Ø§Ù„Ù…Ø­Ù…ÙŠØ©ØŒ ÙˆØ§Ø¯Ø¹Ù… Deep Links & Dynamic Links  
**English**: Use go_router with Guards for protected routes, and support Deep Links & Dynamic Links

## ğŸ’¡ **Ø§Ù„ÙÙˆØ§Ø¦Ø¯ | Benefits**
- **ØªÙ†Ù‚Ù„ Ù†Ø¸ÙŠÙ | Clean Navigation**: ØªÙˆØ¬ÙŠÙ‡ Ù…Ø±ÙƒØ²ÙŠ Ù…Ø¹ Ø£Ù…Ø§Ù† Ø§Ù„Ø£Ù†ÙˆØ§Ø¹
- **Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø© | Deep Linking**: ØªØ¬Ø±Ø¨Ø© Ù…Ø³ØªØ®Ø¯Ù… Ø³Ù„Ø³Ø© Ù…Ø¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©
- **Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª | Route Protection**: ÙˆØµÙˆÙ„ Ø¢Ù…Ù† Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙŠØ©
- **Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø© | State Management**: ÙØµÙ„ Ù…Ù†Ø§Ø³Ø¨ Ø¨ÙŠÙ† UI ÙˆÙ…Ù†Ø·Ù‚ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„
- **Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± | Testing**: Ø³Ù‡ÙˆÙ„Ø© Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙƒÙˆÙ†Ø§Øª UI ÙˆØ§Ù„ØªÙ†Ù‚Ù„
- **Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø© | Maintainability**: ÙØµÙ„ ÙˆØ§Ø¶Ø­ Ù„Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª

## ğŸ› ï¸ **Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ | Implementation**
- **Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ**: Ø¬Ù…ÙŠØ¹ Ø´Ø§Ø´Ø§Øª UI ÙˆØªØ¯ÙÙ‚Ø§Øª Ø§Ù„ØªÙ†Ù‚Ù„ ÙˆØªÙØ§Ø¹Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
- **ÙƒÙŠÙÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚**:
  - Ø¥Ø¹Ø¯Ø§Ø¯ GoRouter Ù…Ø¹ ØªÙƒÙˆÙŠÙ† Ù…Ø³Ø§Ø± Ù…Ø±ÙƒØ²ÙŠ
  - ØªØ·Ø¨ÙŠÙ‚ Ø­Ø±Ø§Ø³ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØªÙÙˆÙŠØ¶
  - Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø© Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª
  - Ø§Ø³ØªØ®Ø¯Ø§Ù… StateNotifier Ù„Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© UI
  - ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø®Ø·Ø§Ø¡ Ù…Ù†Ø§Ø³Ø¨Ø© ÙˆØ­Ø§Ù„Ø§Øª ØªØ­Ù…ÙŠÙ„
- **Ø§Ù„Ù†ØªÙŠØ¬Ø©**: Ø·Ø¨Ù‚Ø© Ø¹Ø±Ø¶ Ù†Ø¸ÙŠÙØ© ÙˆÙ‚Ø§Ø¨Ù„Ø© Ù„Ù„ØµÙŠØ§Ù†Ø© Ù…Ø¹ ØªØ¬Ø±Ø¨Ø© Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù…ØªØ§Ø²Ø©

## ğŸ¯ **Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© | Specific Priorities**

### **Ø£ÙˆÙ„ÙˆÙŠØ§Øª Ø®Ø§ØµØ© Ø¨Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¶ | Presentation Layer Specific Priorities:**
#### **Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø§Ù„Ø£Ø³Ø§Ø³ | Phase 1: Foundation**
- **ğŸ”´ Ø­Ø±Ø¬**: Ø¥Ø¹Ø¯Ø§Ø¯ GoRouter Ù…Ø¹ ØªÙ†Ù‚Ù„ Ø£Ø³Ø§Ø³ÙŠ
- **ğŸ”´ Ø­Ø±Ø¬**: ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ­Ø±Ø§Ø³ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª
- **ğŸŸ  Ø¹Ø§Ù„ÙŠ**: Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø© Ù„Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

#### **Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø§Ù„ØªØ­Ø³ÙŠÙ† | Phase 2: Enhancement**
- **ğŸŸ  Ø¹Ø§Ù„ÙŠ**: ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ø´Ø§Ù…Ù„Ø©
- **ğŸŸ  Ø¹Ø§Ù„ÙŠ**: Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆØ­Ø§Ù„Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„
- **ğŸŸ¡ Ù…ØªÙˆØ³Ø·**: Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø§Øª ØªÙ†Ù‚Ù„ Ù…ØªÙ‚Ø¯Ù…Ø©

#### **Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: Ø§Ù„ØªØ­Ø³ÙŠÙ† | Phase 3: Optimization**
- **ğŸŸ¡ Ù…ØªÙˆØ³Ø·**: ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©
- **ğŸŸ¡ Ù…ØªÙˆØ³Ø·**: Ø£Ù†Ù…Ø§Ø· UI Ù…ØªÙ‚Ø¯Ù…Ø© ÙˆØ¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„
- **ğŸŸ¢ Ù…Ù†Ø®ÙØ¶**: ØªØ®ØµÙŠØµ UI Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ

## ğŸ“ˆ **Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù†Ø¬Ø§Ø­ | Success Metrics**

### **Ù…Ø¤Ø´Ø±Ø§Øª Ø®Ø§ØµØ© Ø¨Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¶ | Presentation Layer Specific Metrics:**
- **Ø£Ø¯Ø§Ø¡ Ø§Ù„ØªÙ†Ù‚Ù„ | Navigation Performance**: <100ms Ø§Ù†ØªÙ‚Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª
- **Ù†Ø¬Ø§Ø­ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø© | Deep Link Success**: 100% ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø©
- **Ø£Ù…Ø§Ù† Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª | Route Security**: 100% Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙŠØ© Ù…Ø¤Ù…Ù†Ø©
- **Ø§Ø³ØªØ¬Ø§Ø¨Ø© UI | UI Responsiveness**: <16ms Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª
- **Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ | Error Handling**: 100% Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø©
- **Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ | Accessibility**: Ø§Ù…ØªØ«Ø§Ù„ WCAG 2.1 AA

## âš ï¸ **Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© ÙˆØ£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª | Common Pitfalls & Best Practices**

### **Ø£Ø®Ø·Ø§Ø¡ Ø®Ø§ØµØ© Ø¨Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¶ | Presentation Layer Specific Pitfalls:**
- **ØªØ¬Ù†Ø¨**: Ù…Ù†Ø·Ù‚ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ÙÙŠ Ù…ÙƒÙˆÙ†Ø§Øª UI
- **ØªØ¬Ù†Ø¨**: Ø­Ø±Ø§Ø³ Ù…Ø³Ø§Ø±Ø§Øª Ù…ÙÙ‚ÙˆØ¯Ø© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙŠØ©
- **ØªØ¬Ù†Ø¨**: Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø®Ø·Ø§Ø¡ ÙˆØ­Ø§Ù„Ø§Øª ØªØ­Ù…ÙŠÙ„ Ø¶Ø¹ÙŠÙØ©
- **ØªØ¬Ù†Ø¨**: Ø£Ù†Ù…Ø§Ø· ØªÙ†Ù‚Ù„ ØºÙŠØ± Ù…ØªØ³Ù‚Ø©
- **ØªØ¬Ù†Ø¨**: Ø¯Ø¹Ù… Ø±ÙˆØ§Ø¨Ø· Ø¹Ù…ÙŠÙ‚Ø© Ù…ÙÙ‚ÙˆØ¯

### **Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª | Best Practices:**
- **Ø§Ø³ØªØ®Ø¯Ù…**: GoRouter Ù„Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ
- **Ø§Ø³ØªØ®Ø¯Ù…**: Ø­Ø±Ø§Ø³ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ù„Ù„Ø£Ù…Ø§Ù†
- **Ø§Ø³ØªØ®Ø¯Ù…**: StateNotifier Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø©
- **Ø§Ø³ØªØ®Ø¯Ù…**: Ø£Ù†Ù…Ø§Ø· Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø®Ø·Ø§Ø¡ Ù…Ù†Ø§Ø³Ø¨Ø©
- **Ø§Ø³ØªØ®Ø¯Ù…**: Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø© Ù„ØªØ¬Ø±Ø¨Ø© Ù…Ø³ØªØ®Ø¯Ù… Ø£ÙØ¶Ù„

## ğŸ§­ **Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ù‚Ù„ | Navigation Setup**

### **1. ØªÙƒÙˆÙŠÙ† GoRouter | GoRouter Configuration**
```dart
class AppRouter {
  static final GoRouter _router = GoRouter(
    initialLocation: '/',
    routes: [
      // Public routes
      GoRoute(
        path: '/',
        name: 'home',
        builder: (context, state) => const HomePage(),
      ),
      GoRoute(
        path: '/login',
        name: 'login',
        builder: (context, state) => const LoginPage(),
      ),
      GoRoute(
        path: '/register',
        name: 'register',
        builder: (context, state) => const RegisterPage(),
      ),
      
      // Product routes
      GoRoute(
        path: '/products',
        name: 'products',
        builder: (context, state) => const ProductsPage(),
        routes: [
          GoRoute(
            path: '/:id',
            name: 'product-detail',
            builder: (context, state) {
              final productId = state.pathParameters['id']!;
              return ProductDetailPage(productId: productId);
            },
          ),
        ],
      ),
      
      // Protected routes
      GoRoute(
        path: '/profile',
        name: 'profile',
        builder: (context, state) => const ProfilePage(),
        redirect: (context, state) => _authGuard(context, state),
      ),
      GoRoute(
        path: '/cart',
        name: 'cart',
        builder: (context, state) => const CartPage(),
        redirect: (context, state) => _authGuard(context, state),
      ),
      GoRoute(
        path: '/orders',
        name: 'orders',
        builder: (context, state) => const OrdersPage(),
        redirect: (context, state) => _authGuard(context, state),
      ),
    ],
    errorBuilder: (context, state) => const ErrorPage(),
  );

  static GoRouter get router => _router;
}
```

### **2. Ø­Ø±Ø§Ø³ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª | Route Guards**
```dart
String? _authGuard(BuildContext context, GoRouterState state) {
  final authState = context.read<AuthNotifier>().state;
  
  if (authState is AuthLoading) {
    return '/loading';
  }
  
  if (authState is AuthUnauthenticated) {
    return '/login';
  }
  
  return null; // Allow navigation
}

class AuthGuard extends ConsumerWidget {
  final Widget child;
  final String redirectTo;

  const AuthGuard({
    super.key,
    required this.child,
    this.redirectTo = '/login',
  });

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final authState = ref.watch(authNotifierProvider);

    return authState.when(
      loading: () => const LoadingPage(),
      authenticated: (user) => child,
      unauthenticated: () => const LoginPage(),
      error: (error) => ErrorPage(error: error),
    );
  }
}
```

## ğŸ”— **Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø© | Deep Linking**

### **1. ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø© | Deep Link Configuration**
```dart
class DeepLinkHandler {
  static void handleDeepLink(String link) {
    final uri = Uri.parse(link);
    
    switch (uri.host) {
      case 'product':
        final productId = uri.pathSegments.last;
        AppRouter.router.go('/products/$productId');
        break;
      case 'order':
        final orderId = uri.pathSegments.last;
        AppRouter.router.go('/orders/$orderId');
        break;
      case 'category':
        final categoryId = uri.pathSegments.last;
        AppRouter.router.go('/products?category=$categoryId');
        break;
      default:
        AppRouter.router.go('/');
    }
  }
}

// Firebase Dynamic Links
class DynamicLinkService {
  static Future<String> createProductLink(String productId) async {
    final parameters = DynamicLinkParameters(
      uriPrefix: 'https://zahraah.page.link',
      link: Uri.parse('https://zahraah.com/product/$productId'),
      androidParameters: const AndroidParameters(
        packageName: 'com.zahraah.app',
        minimumVersion: 1,
      ),
      iosParameters: const IOSParameters(
        bundleId: 'com.zahraah.app',
        minimumVersion: '1.0.0',
      ),
      socialMetaTagParameters: SocialMetaTagParameters(
        title: 'Check out this product on Zahraah',
        description: 'Discover amazing products on Zahraah',
        imageUrl: Uri.parse('https://zahraah.com/images/logo.png'),
      ),
    );

    final shortLink = await FirebaseDynamicLinks.instance.buildShortLink(parameters);
    return shortLink.shortUrl.toString();
  }
}
```

## ğŸ›ï¸ **Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø© | State Management**

### **1. ØªÙ†ÙÙŠØ° StateNotifier | StateNotifier Implementation**
```dart
// Product State
@freezed
class ProductState with _$ProductState {
  const factory ProductState({
    @Default([]) List<Product> products,
    @Default(false) bool isLoading,
    @Default(false) bool hasError,
    String? errorMessage,
    String? selectedCategory,
    String? searchQuery,
  }) = _ProductState;
}

// Product Notifier
class ProductNotifier extends StateNotifier<ProductState> {
  final GetProductsUseCase _getProductsUseCase;

  ProductNotifier(this._getProductsUseCase) : super(const ProductState());

  Future<void> loadProducts({
    String? category,
    String? searchQuery,
  }) async {
    state = state.copyWith(isLoading: true, hasError: false);

    final result = await _getProductsUseCase.call(
      category: category,
      searchQuery: searchQuery,
    );

    result.fold(
      (products) => state = state.copyWith(
        products: products,
        isLoading: false,
        selectedCategory: category,
        searchQuery: searchQuery,
      ),
      (error) => state = state.copyWith(
        isLoading: false,
        hasError: true,
        errorMessage: error.message,
      ),
    );
  }

  void setCategory(String category) {
    state = state.copyWith(selectedCategory: category);
    loadProducts(category: category);
  }

  void setSearchQuery(String query) {
    state = state.copyWith(searchQuery: query);
    loadProducts(searchQuery: query);
  }
}
```

### **2. Ø¥Ø¹Ø¯Ø§Ø¯ Provider | Provider Setup**
```dart
// Providers
final productNotifierProvider = StateNotifierProvider<ProductNotifier, ProductState>(
  (ref) => ProductNotifier(ref.read(getProductsUseCaseProvider)),
);

final authNotifierProvider = StateNotifierProvider<AuthNotifier, AuthState>(
  (ref) => AuthNotifier(ref.read(loginUseCaseProvider)),
);

// Use case providers
final getProductsUseCaseProvider = Provider<GetProductsUseCase>(
  (ref) => GetProductsUseCase(ref.read(productRepositoryProvider)),
);

final productRepositoryProvider = Provider<ProductRepository>(
  (ref) => ProductRepositoryImpl(
    remoteDataSource: ref.read(productRemoteDataSourceProvider),
    localDataSource: ref.read(productLocalDataSourceProvider),
    networkInfo: ref.read(networkInfoProvider),
  ),
);
```

## ğŸ–¼ï¸ **Ù…ÙƒÙˆÙ†Ø§Øª ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… | UI Components**

### **1. Ù…ÙƒÙˆÙ†Ø§Øª ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© | Base UI Components**
```dart
class LoadingWidget extends StatelessWidget {
  final String? message;
  
  const LoadingWidget({super.key, this.message});

  @override
  Widget build(BuildContext context) {
    return Center(
      child: Column(
        mainAxisAlignment: MainAxisAlignment.center,
        children: [
          const CircularProgressIndicator(),
          if (message != null) ...[
            const SizedBox(height: 16),
            Text(
              message!,
              style: Theme.of(context).textTheme.bodyMedium,
            ),
          ],
        ],
      ),
    );
  }
}

class ErrorWidget extends StatelessWidget {
  final String message;
  final VoidCallback? onRetry;
  
  const ErrorWidget({
    super.key,
    required this.message,
    this.onRetry,
  });

  @override
  Widget build(BuildContext context) {
    return Center(
      child: Column(
        mainAxisAlignment: MainAxisAlignment.center,
        children: [
          Icon(
            Icons.error_outline,
            size: 64,
            color: Theme.of(context).colorScheme.error,
          ),
          const SizedBox(height: 16),
          Text(
            message,
            style: Theme.of(context).textTheme.bodyMedium,
            textAlign: TextAlign.center,
          ),
          if (onRetry != null) ...[
            const SizedBox(height: 16),
            ElevatedButton(
              onPressed: onRetry,
              child: const Text('Retry'),
            ),
          ],
        ],
      ),
    );
  }
}
```

### **2. Ø¹Ù†ØµØ± Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª | Product List Widget**
```dart
class ProductListWidget extends ConsumerWidget {
  const ProductListWidget({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final productState = ref.watch(productNotifierProvider);

    return productState.when(
      loading: () => const LoadingWidget(message: 'Loading products...'),
      error: (error) => ErrorWidget(
        message: error.message,
        onRetry: () => ref.read(productNotifierProvider.notifier).loadProducts(),
      ),
      data: (products) {
        if (products.isEmpty) {
          return const EmptyStateWidget(
            icon: Icons.shopping_bag_outlined,
            title: 'No products found',
            subtitle: 'Try adjusting your search or filters',
          );
        }

        return GridView.builder(
          padding: const EdgeInsets.all(16),
          gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(
            crossAxisCount: 2,
            childAspectRatio: 0.7,
            crossAxisSpacing: 16,
            mainAxisSpacing: 16,
          ),
          itemCount: products.length,
          itemBuilder: (context, index) {
            final product = products[index];
            return ProductCard(product: product);
          },
        );
      },
    );
  }
}
```

## ğŸ¨ **Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… | UI State Management**

### **1. Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ | Loading States**
```dart
class ProductDetailPage extends ConsumerWidget {
  final String productId;

  const ProductDetailPage({super.key, required this.productId});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final productState = ref.watch(productDetailNotifierProvider(productId));

    return Scaffold(
      appBar: AppBar(title: const Text('Product Details')),
      body: productState.when(
        loading: () => const LoadingWidget(message: 'Loading product...'),
        error: (error) => ErrorWidget(
          message: error.message,
          onRetry: () => ref.read(productDetailNotifierProvider(productId).notifier)
              .loadProduct(productId),
        ),
        data: (product) => ProductDetailContent(product: product),
      ),
    );
  }
}
```

### **2. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ | Error Handling**
```dart
class ErrorBoundary extends ConsumerWidget {
  final Widget child;
  final Widget Function(AppError error)? errorBuilder;

  const ErrorBoundary({
    super.key,
    required this.child,
    this.errorBuilder,
  });

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return child;
  }
}

class GlobalErrorHandler {
  static void handleError(AppError error, {StackTrace? stackTrace}) {
    // Log error
    ErrorLogger.logError(error, stackTrace: stackTrace);
    
    // Show user-friendly message
    // This would typically be handled by a global error handler
    // that shows snackbars or dialogs
  }
}
```

## ğŸ§ª **Ø§Ø®ØªØ¨Ø§Ø± Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¶ | Testing Presentation Layer**

### **1. Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ù†Ø§ØµØ± | Widget Tests**
```dart
void main() {
  group('ProductListWidget', () {
    testWidgets('should show loading state', (tester) async {
      // Arrange
      final container = ProviderContainer(
        overrides: [
          productNotifierProvider.overrideWith(
            (ref) => MockProductNotifier()..setLoading(true),
          ),
        ],
      );

      // Act
      await tester.pumpWidget(
        ProviderScope(
          parent: container,
          child: const MaterialApp(
            home: ProductListWidget(),
          ),
        ),
      );

      // Assert
      expect(find.byType(CircularProgressIndicator), findsOneWidget);
      expect(find.text('Loading products...'), findsOneWidget);
    });

    testWidgets('should show products when loaded', (tester) async {
      // Arrange
      final products = [
        Product(
          id: '1',
          name: 'Test Product',
          description: 'Test Description',
          price: 99.99,
          category: 'Electronics',
          images: ['image1.jpg'],
          stockQuantity: 10,
          isAvailable: true,
          createdAt: DateTime.now(),
          updatedAt: DateTime.now(),
        ),
      ];

      final container = ProviderContainer(
        overrides: [
          productNotifierProvider.overrideWith(
            (ref) => MockProductNotifier()..setProducts(products),
          ),
        ],
      );

      // Act
      await tester.pumpWidget(
        ProviderScope(
          parent: container,
          child: const MaterialApp(
            home: ProductListWidget(),
          ),
        ),
      );

      // Assert
      expect(find.text('Test Product'), findsOneWidget);
      expect(find.text('\$99.99'), findsOneWidget);
    });
  });
}
```

### **2. Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙ†Ù‚Ù„ | Navigation Tests**
```dart
void main() {
  group('Navigation Tests', () {
    testWidgets('should navigate to product detail', (tester) async {
      // Arrange
      await tester.pumpWidget(
        MaterialApp.router(
          routerConfig: AppRouter.router,
        ),
      );

      // Act
      await tester.tap(find.text('View Product'));
      await tester.pumpAndSettle();

      // Assert
      expect(find.byType(ProductDetailPage), findsOneWidget);
    });

    testWidgets('should redirect to login when not authenticated', (tester) async {
      // Arrange
      final container = ProviderContainer(
        overrides: [
          authNotifierProvider.overrideWith(
            (ref) => MockAuthNotifier()..setUnauthenticated(),
          ),
        ],
      );

      await tester.pumpWidget(
        ProviderScope(
          parent: container,
          child: MaterialApp.router(
            routerConfig: AppRouter.router,
          ),
        ),
      );

      // Act
      AppRouter.router.go('/profile');
      await tester.pumpAndSettle();

      // Assert
      expect(find.byType(LoginPage), findsOneWidget);
    });
  });
}
```

## ğŸ“‹ **Ù‚Ø§Ø¦Ù…Ø© Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙ†ÙÙŠØ° | Implementation Checklist**

### **1. Navigation**
- [ ] Set up GoRouter with route configuration
- [ ] Implement route guards for authentication
- [ ] Add deep linking support
- [ ] Test all navigation flows

### **2. State Management**
- [ ] Implement StateNotifier for UI state
- [ ] Set up providers for dependency injection
- [ ] Add proper error handling
- [ ] Test state management logic

### **3. UI Components**
- [ ] Create reusable UI components
- [ ] Implement loading and error states
- [ ] Add proper accessibility support
- [ ] Test all UI components

### **4. Deep Linking**
- [ ] Configure Firebase Dynamic Links
- [ ] Implement deep link handling
- [ ] Test deep link functionality
- [ ] Add proper error handling

### **5. Testing**
- [ ] Write widget tests for UI components
- [ ] Test navigation flows
- [ ] Test state management
- [ ] Achieve high test coverage

---

**Next Tab**: Design System | Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµÙ…ÙŠÙ…

