# 01. ูุธุฑุฉ ูุนูุงุฑูุฉ | Architecture Overview

## ๐ฏ **ูุธุฑุฉ ุนุงูุฉ | Overview**

ูุธุฑุฉ ุดุงููุฉ ุนูู ุงูุจููุฉ ุงููุนูุงุฑูุฉ ููุงุฌูุงุช RESTful API ูู ููุตุฉ **ุฒูุฑุงุก**ุ ุชุบุทู ุงูุทุจูุงุช ุงูุฃุณุงุณูุฉุ ุงูููููุงุชุ ูุงูุชุฏููุงุช.

**ุงููุฏู | Purpose**: ููู ุงูุนูุงุฑุฉ ุงููููุฉ ููู API  
**ุงูุฌูููุฑ | Audience**: ูููุฏุณู ุงูุจุฑูุฌูุงุชุ ูููุฏุณู DevOps  
**ุงููุชุทูุจุงุช | Prerequisites**: ููู [ูุจุงุฏุฆ REST](../01-Core-Principles/01_REST_Design_Principles.md)

---

## ๐ **ุฌุฏูู ุงููุญุชููุงุช | Table of Contents**

1. [ุงูุนูุงุฑุฉ ุฑููุนุฉ ุงููุณุชูู](#ุงูุนูุงุฑุฉ-ุฑููุนุฉ-ุงููุณุชูู)
2. [ุงูุทุจูุงุช ุงูุฃุณุงุณูุฉ](#ุงูุทุจูุงุช-ุงูุฃุณุงุณูุฉ)
3. [ุชุฏูู ุงูุทูุจุงุช](#ุชุฏูู-ุงูุทูุจุงุช)
4. [ุงูุจูุฆุงุช](#ุงูุจูุฆุงุช)
5. [ุงูููููุงุช ุงูุฃุณุงุณูุฉ](#ุงูููููุงุช-ุงูุฃุณุงุณูุฉ)

---

## 1๏ธโฃ ุงูุนูุงุฑุฉ ุฑููุนุฉ ุงููุณุชูู | High-Level Architecture {#ุงูุนูุงุฑุฉ-ุฑููุนุฉ-ุงููุณุชูู}

### **ูุฎุทุท ุงูุนูุงุฑุฉ**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         ุงูุนููุงุก | Clients                        โ
โ  Flutter App (iOS/Android)  โ  Web App  โ  Partner Apps         โ
โโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ
                        โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ุงูุญุงูุฉ | Edge Layer                          โ
โ  CDN + WAF + DDoS Protection (Cloudflare)                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ
                        โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                 ููุงุฒู ุงูุญูู | Load Balancer                      โ
โ  NGINX / AWS ALB / GCP Load Balancer                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ
                        โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                ุจูุงุจุฉ ุงูู API | API Gateway                       โ
โ  - Authentication (JWT/OAuth2)                                  โ
โ  - Rate Limiting                                                โ
โ  - CORS                                                         โ
โ  - Request Routing                                              โ
โ  - Tracing (X-Request-ID)                                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ
                        โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ               ุฎุฏูุงุช ุงูู API | API Services Layer                 โ
โ  โโโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโโ    โ
โ  โ Products  โ  โ Orders   โ  โ Payments โ  โ Customers  โ    โ
โ  โ Service   โ  โ Service  โ  โ Service  โ  โ Service    โ    โ
โ  โโโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโโ    โ
โ  โโโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโโ    โ
โ  โ Shipping  โ  โ Returns  โ  โ Reviews  โ  โ Analytics  โ    โ
โ  โ Service   โ  โ Service  โ  โ Service  โ  โ Service    โ    โ
โ  โโโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโโ    โ
โโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ
                        โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  ุทุจูุฉ ุงูุจูุงูุงุช | Data Layer                      โ
โ  โโโโโโโโโโโโ  โโโโโโโโโ  โโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโ     โ
โ  โ MySQL    โ  โ Redis โ  โ Queue  โ  โ Object Storage  โ     โ
โ  โ (Primary)โ  โ(Cache)โ  โ(RabbitMQโ  โ (S3/Cloudflare)โ     โ
โ  โโโโโโโโโโโโ  โโโโโโโโโ  โโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโ     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ
                        โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              ุงููุฑุงูุจุฉ | Observability Layer                      โ
โ  Logging (JSON) + Metrics (Prometheus) + Tracing (Jaeger)      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 2๏ธโฃ ุงูุทุจูุงุช ุงูุฃุณุงุณูุฉ | Core Layers {#ุงูุทุจูุงุช-ุงูุฃุณุงุณูุฉ}

### **1. ุทุจูุฉ ุงูุญุงูุฉ | Edge Layer**

#### **ุงููุณุคูููุงุช**
- โ ุญูุงูุฉ DDoS
- โ ุฌุฏุงุฑ ุญูุงูุฉ ุชุทุจููุงุช ุงูููุจ (WAF)
- โ ุฅููุงุก TLS/SSL
- โ ุงูุชุฎุฒูู ุงููุคูุช ุงูุซุงุจุช (Static Caching)
- โ ุถุบุท ุงููุญุชูู (Gzip/Brotli)

#### **ุงูุชูููุงุช**
- **Cloudflare**: ุงูุญูุงูุฉ ูุงููุงุด ุนูู ุงูุญุงูุฉ
- **TLS 1.3**: ุชุดููุฑ ุขูู
- **HTTP/2, HTTP/3**: ุฃุฏุงุก ุฃูุถู

---

### **2. ููุงุฒู ุงูุญูู | Load Balancer**

#### **ุงููุณุคูููุงุช**
- โ ุชูุฒูุน ุงูุญูู ุนุจุฑ ุงูุฎูุงุฏู
- โ ูุญุต ุงูุตุญุฉ (Health Checks)
- โ SSL/TLS Termination
- โ Session Persistence (ุฅุฐุง ูุฒู)

#### **ุงุณุชุฑุงุชูุฌูุงุช ุงูุชูุฒูุน**
- **Round Robin**: ุชูุฒูุน ูุชุณุงูู
- **Least Connections**: ุฃูู ุงุชุตุงูุงุช ูุดุทุฉ
- **IP Hash**: ุซุจุงุช ุงูุฌูุณุฉ

---

### **3. ุจูุงุจุฉ ุงูู API | API Gateway**

#### **ุงููุณุคูููุงุช ุงูุฑุฆูุณูุฉ**

##### **ุงููุตุงุฏูุฉ ูุงูุชุฎููู | Authentication & Authorization**
```
ุงูุนููู โ JWT Token โ Gateway โ ุงูุชุญูู โ ุฎุฏูุงุช ุงูู API
```

- ุชุญูู JWT
- ุชุญุฏูุฏ ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช
- ุฅุฑุฌุงุน 401/403 ุนูุฏ ุงููุดู

##### **ุชุญุฏูุฏ ูุนุฏู ุงูุทูุจุงุช | Rate Limiting**
```
User:     100 req/min
Partner:  600 req/min
Admin:    Unlimited
```

- ุญูุงูุฉ ูู ุฅุณุงุกุฉ ุงูุงุณุชุฎุฏุงู
- ุญุฏูุฏ ูุฎุตุตุฉ ููู ููุน ูุณุชุฎุฏู
- ุฑุคูุณ Rate Limit ูู ุงูุงุณุชุฌุงุจุฉ

##### **CORS - ูุดุงุฑูุฉ ุงูููุงุฑุฏ ุนุจุฑ ุงูุฃุตูู**
```
Allowed Origins:
- https://zahraah.com
- https://app.zahraah.com
- https://m.zahraah.com
```

##### **ุงูุชุชุจุน ูุงููุฑุงูุจุฉ | Tracing & Monitoring**
```http
X-Request-ID: uuid-v4-here
traceparent: 00-4bf92f3577b34da6a3ce929d0e0e4736-00f067aa0ba902b7-01
```

- ุชูููุฏ/ุชูุฑูุฑ ูุนุฑู ุงูุทูุจ
- ุฑุจุท ุงูุณุฌูุงุช ุนุจุฑ ุงูุฎุฏูุงุช
- ุชุชุจุน ููุฒุน

##### **ุงูุชูุฌูู | Routing**
```
/v1/products/*   โ Products Service
/v1/orders/*     โ Orders Service
/v1/payments/*   โ Payments Service
```

#### **ุงูุชูููุงุช**
- **Kong Gateway**
- **NGINX Plus**
- **AWS API Gateway**
- **Cloudflare API Gateway**

---

### **4. ุทุจูุฉ ุฎุฏูุงุช ุงูู API | API Services Layer**

#### **ููุท Microservices / Modular Monolith**

##### **ุงูุฎุฏูุงุช ุงูุฃุณุงุณูุฉ**

| ุงูุฎุฏูุฉ | ุงููุณุคูููุฉ | ูุงุนุฏุฉ ุงูุจูุงูุงุช |
|--------|-----------|----------------|
| **Products Service** | ูุชุงููุฌ ุงูููุชุฌุงุช | products_db |
| **Orders Service** | ุฅุฏุงุฑุฉ ุงูุทูุจุงุช | orders_db |
| **Customers Service** | ุญุณุงุจุงุช ุงูุนููุงุก | customers_db |
| **Payments Service** | ูุนุงูุฌุฉ ุงูุฏูุน | payments_db |
| **Shipping Service** | ุฅุฏุงุฑุฉ ุงูุดุญู | shipping_db |
| **Returns Service** | ูุนุงูุฌุฉ ุงููุฑุชุฌุนุงุช | returns_db |
| **Analytics Service** | ุงูุชุญูููุงุช ูุงูุชูุงุฑูุฑ | analytics_db |

##### **ุงููุจุงุฏุฆ**
- โ **ุนุฏูู ุงูุญุงูุฉ (Stateless)**: ูุง ุฌูุณุงุช ุนูู ุงูุฎุงุฏู
- โ **ุงุณุชููุงููุฉ**: ูู ุฎุฏูุฉ ูุณุชููุฉ
- โ **ูุงุจููุฉ ุงูุชูุณุน**: ุชูุจูุฑ ุฃููู
- โ **ูุดู ูุนุฒูู**: ูุดู ุฎุฏูุฉ ูุง ูุคุซุฑ ุนูู ุงูุฃุฎุฑู

---

### **5. ุทุจูุฉ ุงูุจูุงูุงุช | Data Layer**

#### **ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ | Primary Database**
```
MySQL 8.0+ (ุฃู PostgreSQL 14+)
- InnoDB Engine
- ACID Transactions
- Foreign Keys
- Full-Text Search
```

**ุงูุงุณุชุฎุฏุงู**:
- ุจูุงูุงุช ุงููุนุงููุงุช (OLTP)
- ุนูุงูุงุช ูุนูุฏุฉ
- ุงุณุชุนูุงูุงุช SQL ูุชูุฏูุฉ

#### **ุงูุชุฎุฒูู ุงููุคูุช | Cache Layer**
```
Redis 7.0+
- Key-Value Store
- TTL Support
- Pub/Sub
- Sorted Sets
```

**ุงูุงุณุชุฎุฏุงู**:
- ููุงุฆู ุงูููุชุฌุงุช
- ูุนูููุงุช ุงูุฌูุณุงุช
- ุงูุนุฏุงุฏุงุช (Counters)
- ุงูุชุฎุฒูู ุงููุคูุช ููุงุณุชุนูุงูุงุช

#### **ูุธุงู ุงูุตููู | Message Queue**
```
RabbitMQ / AWS SQS / GCP Pub/Sub
- Async Processing
- Job Queues
- Event Bus
```

**ุงูุงุณุชุฎุฏุงู**:
- ูุนุงูุฌุฉ ุงูุทูุจุงุช
- ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช
- ุชูููุฏ ุงูุชูุงุฑูุฑ
- ุงููุนุงูุฌุฉ ุงูุฏูุนูุฉ

#### **ุชุฎุฒูู ุงููุงุฆูุงุช | Object Storage**
```
S3-Compatible Storage
- Images
- Documents
- Backups
```

**ุงูุงุณุชุฎุฏุงู**:
- ุตูุฑ ุงูููุชุฌุงุช
- ูุณุชูุฏุงุช ุงูุทูุจุงุช
- ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ

---

### **6. ุทุจูุฉ ุงููุฑุงูุจุฉ | Observability Layer**

#### **ุงูุณุฌูุงุช | Logging**
```json
{
  "timestamp": "2025-01-08T12:00:00Z",
  "level": "INFO",
  "service": "orders-service",
  "trace_id": "c9b1f3a0...",
  "user_id": 789,
  "method": "POST",
  "path": "/v1/orders",
  "status": 201,
  "duration_ms": 145
}
```

**ุงูุฃุฏูุงุช**: ELK Stack, Loki, Datadog

#### **ุงูููุงููุณ | Metrics**
```
- Request Rate (QPS)
- Latency (p50, p95, p99)
- Error Rate (4xx, 5xx)
- Saturation (CPU, Memory)
```

**ุงูุฃุฏูุงุช**: Prometheus, Grafana, Datadog

#### **ุงูุชุชุจุน ุงูููุฒุน | Distributed Tracing**
```
Request โ Gateway โ Products Service โ DB
  โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโฌโโโโโโโโโ
        Trace ID ูุฑุจุท ุงููู
```

**ุงูุฃุฏูุงุช**: Jaeger, Zipkin, OpenTelemetry

---

## 3๏ธโฃ ุชุฏูู ุงูุทูุจุงุช | Request Flow {#ุชุฏูู-ุงูุทูุจุงุช}

### **ูุซุงู: ุฅูุดุงุก ุทูุจ**

```
1. ุงูุนููู (Flutter App)
   POST /v1/orders
   Authorization: Bearer <jwt>
   Idempotency-Key: uuid
   โ

2. ุงูุญุงูุฉ (Cloudflare)
   - ูุญุต WAF
   - ุงูุชุญูู ูู TLS
   - ุชูุฑูุฑ ููููุงุฒู
   โ

3. ููุงุฒู ุงูุญูู (NGINX)
   - ุงุฎุชูุงุฑ ุฎุงุฏู Gateway
   - ุชูุฌูู ุงูุทูุจ
   โ

4. ุจูุงุจุฉ ุงูู API (Kong)
   - ุชุญูู JWT (โ ุตุงูุญ)
   - ูุญุต Rate Limit (โ ุถูู ุงูุญุฏ)
   - ูุญุต CORS (โ ูุตุฑุญ)
   - ุญูู X-Request-ID
   - ุชูุฌูู โ Orders Service
   โ

5. ุฎุฏูุฉ ุงูุทูุจุงุช (Orders Service)
   - ุงูุชุญูู ูู Idempotency Key
   - ุงูุชุญูู ูู ุงูุจูุงูุงุช
   - ุงูุชุญูู ูู ุงููุฎุฒูู (โ Products Service)
   - ุฅูุดุงุก ุงูุทูุจ ูู DB
   - ุญุฌุฒ ุงููุฎุฒูู
   - ูุดุฑ ุญุฏุซ order.created (โ Queue)
   - ุฅุฑุฌุงุน 201 Created
   โ

6. ุจูุงุจุฉ ุงูู API
   - ุฅุถุงูุฉ ุฑุคูุณ (RateLimit, Trace)
   - ุชุณุฌูู ูู Logs
   - ุฅุฑุณุงู Metrics
   โ

7. ุงูุนููู
   - ุงุณุชูุงู 201 Created
   - Location: /v1/orders/ORD-123
   - ุนุฑุถ ุชุฃููุฏ ุงูุทูุจ
```

---

## 4๏ธโฃ ุงูุจูุฆุงุช | Environments {#ุงูุจูุฆุงุช}

### **ุงูุจูุฆุงุช ุงูุซูุงุซ**

| ุงูุจูุฆุฉ | ุงููุทุงู | ุงููุฏู | ุงูุจูุงูุงุช |
|--------|--------|-------|---------|
| **Development** | `dev-api.zahraah.com` | ุงูุชุทููุฑ ุงููุดุท | ุจูุงูุงุช ููููุฉ |
| **Staging** | `staging-api.zahraah.com` | ุงุฎุชุจุงุฑุงุช ูุง ูุจู ุงูุฅูุชุงุฌ | ุจูุงูุงุช ุดุจููุฉ ุจุงูุฅูุชุงุฌ |
| **Production** | `api.zahraah.com` | ุงูุจูุฆุฉ ุงูุญูุฉ | ุจูุงูุงุช ุญููููุฉ |

### **ุงููุตู ุงููุงูู**
```
Dev:      โ ุจูุงูุงุช ููููุฉ
          โ ููุงุชูุญ ุงุฎุชุจุงุฑ
          โ ุณุฌูุงุช ููุตูุฉ

Staging:  โ ุจูุงูุงุช ุดุจููุฉ
          โ ุงุฎุชุจุงุฑุงุช ุฏุฎุงููุฉ
          โ ูุฑุงุฌุนุฉ QA

Prod:     โ ุจูุงูุงุช ุญููููุฉ
          โ ูุฑุงูุจุฉ ูุดุฏุฏุฉ
          โ ูุดุฑ ุญุฐุฑ (Canary)
```

---

## 5๏ธโฃ ุงูููููุงุช ุงูุฃุณุงุณูุฉ | Core Components {#ุงูููููุงุช-ุงูุฃุณุงุณูุฉ}

### **1. ุฎุฏูุฉ ุงููุตุงุฏูุฉ | Auth Service**
```
ุงููุณุคูููุงุช:
- ุชุณุฌูู ุงูุฏุฎูู (OTP, Social)
- ุฅุตุฏุงุฑ JWT
- ุชุฌุฏูุฏ ุงูุฑููุฒ
- ุฅุฏุงุฑุฉ ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช
```

### **2. ุฎุฏูุฉ ุงูุฅุดุนุงุฑุงุช | Notifications Service**
```
ุงููููุงุช:
- SMS (OTP, ุชุญุฏูุซุงุช ุงูุทูุจ)
- WhatsApp (ุชุฃููุฏุงุช)
- Push Notifications (ุนุฑูุถ)
- Email (ููุงุชูุฑ)
```

### **3. ุฎุฏูุฉ ุงูุชุญูููุงุช | Analytics Service**
```
ุงูุชูุงููุงุช:
- Firebase Analytics
- Google Analytics 4
- BigQuery (Data Warehouse)
```

---

## ๐ **ูุคุดุฑุงุช ุงูุฃุฏุงุก | Performance Targets**

| ุงููุคุดุฑ | ุงููุฏู | ุงูููุงุณ |
|--------|-------|--------|
| **ุฒูู ุงูุงุณุชุฌุงุจุฉ P95** | โค 300ms | ูู ุงููุฑุงูุจุฉ |
| **ุงูุชููุฑ** | โฅ 99.9% ุดูุฑููุง | Uptime Monitoring |
| **ูุนุฏู ุงูุฃุฎุทุงุก** | โค 0.1% (5xx) | Error Logs |
| **ูุนุฏู ุงูุชุฎุฒูู ุงููุคูุช** | โฅ 80% | Redis Metrics |

---

## ๐ **ุงูุชููู | Navigation**

[โ ุงูุณุงุจู: ุฃุณุงููุจ HTTP | Previous: HTTP Methods](../01-Core-Principles/03_HTTP_Methods_Status.md)

[ุงูุชุงูู: ุจูุงุจุฉ ุงูู API | Next: API Gateway โ](02_API_Gateway.md)

[๐ ุงูุนูุฏุฉ ููููุฑุณ | Back to Index](../index.md)

---

## ๐ **ุงููุฑุงุฌุน | References**

- [Microservices Architecture](https://microservices.io/)
- [API Gateway Pattern](https://docs.microsoft.com/en-us/azure/architecture/microservices/design/gateway)
- [Cloud Architecture Best Practices](https://cloud.google.com/architecture/framework)

---

**ุงูุฅุตุฏุงุฑ | Version**: 1.0  
**ุขุฎุฑ ุชุญุฏูุซ | Last Updated**: 2025-01-08  
**ุงูุญุงูุฉ | Status**: โ ูุฑุงุฌุน ููุนุชูุฏ | Reviewed and Approved