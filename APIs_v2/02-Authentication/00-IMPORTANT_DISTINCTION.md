# âš ï¸ ØªÙ…ÙŠÙŠØ² Ø­Ø±Ø¬: Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ† | Critical Distinction: Customers vs Admin Users
**Ø§Ù„Ø£Ù‡Ù…ÙŠØ© | Importance**: ğŸ”´ Ø­Ø±Ø¬ Ø¬Ø¯Ø§Ù‹ | Critical

---

## **Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© | The Golden Rule**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚  Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ â‰  Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠÙˆÙ†                                            â”‚
â”‚  Customers â‰  Admin Users                                        â”‚
â”‚                                                                  â”‚
â”‚  âš ï¸ Ù„Ø¯ÙŠÙ‡Ù… Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ù…Ø®ØªÙ„ÙØ© ØªÙ…Ø§Ù…Ø§Ù‹ Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØªØ®ÙˆÙŠÙ„            â”‚
â”‚  âš ï¸ They have completely different authentication needs         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## **Ù†ÙˆØ¹Ø§Ù† Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† | Two User Types**

### **Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ | Customers (End Users)**

**Ø§Ù„ÙˆØµÙ | Description:**

- Ù…Ø³ØªØ®Ø¯Ù…Ùˆ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠÙˆÙ†
- Ø§Ù„Ù…ØªØ³ÙˆÙ‚ÙˆÙ† ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©
- Ù…Ø³ØªØ®Ø¯Ù…Ùˆ ØªØ·Ø¨ÙŠÙ‚ Mobile Ø£Ùˆ Web

**Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© | Authentication:**

- **Sanctum ÙÙ‚Ø·** Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø©
- **Token-based** authentication
- **Ù„Ø§ ÙŠØ­ØªØ§Ø¬ÙˆÙ†** Ù†Ø¸Ø§Ù… Roles
- **Ù„Ø§ ÙŠØ­ØªØ§Ø¬ÙˆÙ†** Ù†Ø¸Ø§Ù… Permissions

**Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙˆØµÙˆÙ„ | Access Control:**

- **Ownership-based** - ÙŠÙ…ÙƒÙ†Ù‡Ù… Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù…ÙˆØ§Ø±Ø¯Ù‡Ù… ÙÙ‚Ø·
- **Policy-based** - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ù…ÙˆØ±Ø¯
- Ù…Ø«Ø§Ù„: ÙŠÙ…ÙƒÙ† Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø±Ø¤ÙŠØ© Ø·Ù„Ø¨Ø§ØªÙ‡ ÙÙ‚Ø·ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡ Ø±Ø¤ÙŠØ© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†

**Ù…Ø«Ø§Ù„ Ø§Ù„Ù€API Response:**

```json
{
  "user": {
    "id": 123,
    "name": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
    "email": "ahmed@example.com",
    "phone": "+966501234567"
  },
  "token": "1|abc123xyz..."
}

// âš ï¸ Ù„Ø§Ø­Ø¸: Ù„Ø§ ØªÙˆØ¬Ø¯ roles Ø£Ùˆ permissions
```

**Routes (API):**

```
GET  /api/v1/products              â† Ø¹Ø§Ù…ØŒ Ù„Ø§ ÙŠØ­ØªØ§Ø¬ authentication
POST /api/v1/auth/register         â† ØªØ³Ø¬ÙŠÙ„ Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
POST /api/v1/auth/login            â† ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„

GET  /api/v1/my-orders             â† Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙÙ‚Ø· (auth required)
GET  /api/v1/my-profile            â† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ (auth required)
POST /api/v1/cart                  â† Ø³Ù„Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ (auth required)
```

**âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©:**
Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ **ÙŠØ³ØªØ®Ø¯Ù…ÙˆÙ† APIs ÙÙ‚Ø·** (Stateless, Token-based)

---

### **Ù…Ø³ØªØ®Ø¯Ù…Ùˆ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Admin Panel Users**

**Ø§Ù„ÙˆØµÙ | Description:**

- Ø§Ù„Ù…ÙˆØ¸ÙÙˆÙ† ÙˆØ§Ù„Ø¥Ø¯Ø§Ø±ÙŠÙˆÙ†
- ÙØ±ÙŠÙ‚ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ
- Ø§Ù„Ù…Ø´Ø±ÙÙˆÙ† ÙˆØ§Ù„Ù…Ø¯ÙŠØ±ÙˆÙ†
- Ø£ÙŠ Ø´Ø®Øµ ÙŠØ¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ù† Ø®Ù„Ø§Ù„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…

**Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© | Authentication:**

- **Sanctum** Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø©
- **RBAC System** - Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
- **Roles**: admin, support, manager, moderator
- **Permissions**: products:*, orders:*, users:*

**Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙˆØµÙˆÙ„ | Access Control:**

- **Permission-based** - Ø­Ø³Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ø·Ø§Ø©
- **Role-based** - Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ± Ø§Ù„ÙˆØ¸ÙŠÙÙŠ
- Ù…Ø«Ø§Ù„: Ù…Ø³ØªØ®Ø¯Ù… Support ÙŠÙ…ÙƒÙ†Ù‡ Ø±Ø¤ÙŠØ© ÙˆØªØ¹Ø¯ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Ø­Ø³Ø¨ ØµÙ„Ø§Ø­ÙŠØ§ØªÙ‡)

**Ù…Ø«Ø§Ù„ Ø§Ù„Ù€API Response:**

```json
{
  "user": {
    "id": 456,
    "name": "Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯",
    "email": "mohamed@company.com",
    "roles": ["support", "moderator"],           // âœ… Ù„Ø¯ÙŠÙ‡ Ø£Ø¯ÙˆØ§Ø±
    "permissions": [                             // âœ… Ù„Ø¯ÙŠÙ‡ ØµÙ„Ø§Ø­ÙŠØ§Øª
      "orders:read",
      "orders:update",
      "users:read",
      "products:update"
    ]
  },
  "token": "2|xyz789abc..."
}
```

**Routes (Web - NOT API):**

```
GET  /admin/login                  â† ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
POST /admin/login                  â† ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¥Ø¯Ø§Ø±ÙŠ

GET  /admin/dashboard              â† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
GET  /admin/orders                 â† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (permission: orders:read)
POST /admin/orders/{id}/update     â† ØªØ­Ø¯ÙŠØ« Ø·Ù„Ø¨ (permission: orders:update)
GET  /admin/users                  â† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (permission: users:read)
POST /admin/products               â† Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ (permission: products:write)
```

**âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù‡Ù…Ø©:**Ù…Ø³ØªØ®Ø¯Ù…Ùˆ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… **Ù„Ø§ ÙŠØ³ØªØ®Ø¯Ù…ÙˆÙ† APIs Ù…Ø¨Ø§Ø´Ø±Ø©**:

- ÙŠØ³ØªØ®Ø¯Ù…ÙˆÙ† Traditional Web (Blade/Inertia/Livewire)
- Session-based authentication
- ÙŠØ´Ø§Ø±ÙƒÙˆÙ† Ù†ÙØ³ Models Ùˆ Services Ù…Ø¹ Ø§Ù„Ù€APIs
- **Ù„ÙƒÙ† Ù„Ù‡Ù… Controllers Ù…Ù†ÙØµÙ„Ø©** (`Admin\*` Ù„ÙŠØ³ `API\*`)

---

## **Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ© | Technical Architecture**

### **ï¸ Important: Separate Tables & Controllers**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚  ğŸ“± Customer App          ğŸ–¥ï¸ Admin Panel                       â”‚
â”‚  (Mobile/SPA)             (Web Dashboard)                       â”‚
â”‚  â”‚                        â”‚                                     â”‚
â”‚  â”œâ”€ API Controllers       â”œâ”€ Admin Controllers                 â”‚
â”‚  â”‚  (Stateless)           â”‚  (Stateful - Sessions)             â”‚
â”‚  â”‚                        â”‚                                     â”‚
â”‚  â”œâ”€ Sanctum Auth          â”œâ”€ Session Auth + RBAC               â”‚
â”‚  â”‚  (Token-based)         â”‚  (Session-based)                   â”‚
â”‚  â”‚                        â”‚                                     â”‚
â”‚  â”œâ”€ customers table       â”œâ”€ admin_users table                 â”‚
â”‚  â”‚                        â”‚  + roles/permissions tables        â”‚
â”‚  â”‚                        â”‚                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚              â”‚                                                  â”‚
â”‚              â”œâ”€ Shared: Models, Services, Business Logic       â”‚
â”‚              â”‚                                                  â”‚
â”‚              â””â”€ Database: products, orders, etc.               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Database Schema:**

```sql
-- Refer to Database plan for full schema
-- âœ… Ø¬Ø¯ÙˆÙ„ Ù…Ù†ÙØµÙ„ Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ | Separate table for customers
CREATE TABLE customers (
    id BIGINT PRIMARY KEY,
    email VARCHAR(255) UNIQUE,
    password VARCHAR(255),
    -- ... other columns - see Database plan
);

-- âœ… Ø¬Ø¯ÙˆÙ„ Ù…Ù†ÙØµÙ„ Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ† | Separate table for admin users
CREATE TABLE admin_users (
    id BIGINT PRIMARY KEY,
    email VARCHAR(255) UNIQUE,
    password VARCHAR(255),
    -- ... other columns - see Database plan
);

-- âœ… Ø¬Ø¯Ø§ÙˆÙ„ RBAC Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ† ÙÙ‚Ø· | RBAC tables for admins only
CREATE TABLE roles (
    id BIGINT PRIMARY KEY,
    name VARCHAR(50) UNIQUE,        -- admin, support, manager
    -- ... other columns - see Database plan
);

CREATE TABLE permissions (
    id BIGINT PRIMARY KEY,
    name VARCHAR(50) UNIQUE,        -- products:read, orders:*
    -- ... other columns - see Database plan
);

CREATE TABLE admin_user_role (
    admin_user_id BIGINT,
    role_id BIGINT,
    PRIMARY KEY (admin_user_id, role_id),
    FOREIGN KEY (admin_user_id) REFERENCES admin_users(id)
);
```

---

### **Models:**

```php
// âœ… Customer Model - API authentication
class Customer extends Authenticatable
{
    use HasApiTokens;
    protected $fillable = ['name', 'email', 'phone', 'password'];
    protected $hidden = ['password'];
  
    public function orders() { return $this->hasMany(Order::class); }
}

// âœ… AdminUser Model - Session + RBAC
class AdminUser extends Authenticatable
{
    use HasRoles;
    protected $fillable = ['name', 'email', 'password', 'is_active'];
    protected $hidden = ['password'];
}
```

---

### **Controllers:**

```php
// âœ… API Controller - Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ | For Customers
namespace App\Http\Controllers\API;

class OrderController extends Controller
{
    public function index()
    {
        return auth('sanctum')->user()->orders()->paginate(20);
    }
  
    public function show(Order $order)
    {
        if ($order->customer_id !== auth('sanctum')->id()) {
            return response()->json(['message' => 'ØºÙŠØ± Ù…ØµØ±Ø­'], 403);
        }
        return new OrderResource($order);
    }
}

// âœ… Admin Controller - Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ† | For Admin Panel
namespace App\Http\Controllers\Admin;

class OrderController extends Controller
{
    public function index()
    {
        abort_unless(auth()->user()->can('orders:read'), 403);
        return view('admin.orders.index', [
            'orders' => Order::with('customer')->paginate(50)
        ]);
    }
}
```

---

### **Authentication Configuration:**

```php
// config/auth.php - Separate guards
'guards' => [
    'web' => ['driver' => 'session', 'provider' => 'admin_users'],
    'sanctum' => ['driver' => 'sanctum', 'provider' => 'customers'],
],

'providers' => [
    'admin_users' => ['driver' => 'eloquent', 'model' => AdminUser::class],
    'customers' => ['driver' => 'eloquent', 'model' => Customer::class],
],
```

---

### **Routes:**

```php
// routes/api.php - Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙÙ‚Ø· | For Customers Only
Route::prefix('v1')->group(function () {
  
    // Public routes
    Route::post('/auth/register', [API\AuthController::class, 'register']);
    Route::post('/auth/login', [API\AuthController::class, 'login']);
  
    // Protected routes - Sanctum
    Route::middleware('auth:sanctum')->group(function () {
        Route::get('/my-orders', [API\OrderController::class, 'index']);
        Route::get('/my-profile', [API\ProfileController::class, 'show']);
        Route::post('/cart', [API\CartController::class, 'store']);
    });
});

// routes/web.php - Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ† ÙÙ‚Ø· | For Admin Panel Only
Route::prefix('admin')->group(function () {
  
    // Admin login page
    Route::get('/login', [Admin\AuthController::class, 'showLoginForm'])
        ->name('admin.login');
    Route::post('/login', [Admin\AuthController::class, 'login']);
  
    // Protected admin routes - Session-based + RBAC
    Route::middleware(['auth:web'])->group(function () {
      
        Route::get('/dashboard', [Admin\DashboardController::class, 'index'])
            ->name('admin.dashboard');
      
        // Orders management - requires permission
        Route::middleware('can:orders:read')->group(function () {
            Route::get('/orders', [Admin\OrderController::class, 'index']);
            Route::get('/orders/{order}', [Admin\OrderController::class, 'show']);
        });
      
        Route::middleware('can:orders:update')->group(function () {
            Route::put('/orders/{order}', [Admin\OrderController::class, 'update']);
        });
      
    });
});

---

## **Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø³Ø±ÙŠØ¹ | Quick Comparison Table**

| Ø§Ù„Ù…Ø¹ÙŠØ§Ø± | Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡<br>Customers | Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠÙˆÙ†<br>Admin Users |
|---------|---------------------|--------------------------|
| **Ø§Ù„ØªØ·Ø¨ÙŠÙ‚** | Mobile/SPA App | Admin Dashboard (Web) |
| **Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©** | Sanctum (Token) âœ… | Session (Web) âœ… |
| **Guard** | `auth:sanctum` | `auth:web` |
| **Ø§Ù„Ø¬Ø¯ÙˆÙ„** | `customers` | `admin_users` |
| **Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„** | `Customer` | `AdminUser` |
| **Controllers** | `API\*Controller` | `Admin\*Controller` |
| **Routes File** | `routes/api.php` | `routes/web.php` |
| **Routes Prefix** | `/api/v1/*` | `/admin/*` |
| **Response Type** | JSON (API) | Views (Blade/Inertia) |
| **Roles** | âŒ Ù„Ø§ | âœ… Ù†Ø¹Ù… |
| **Permissions** | âŒ Ù„Ø§ | âœ… Ù†Ø¹Ù… |
| **RBAC System** | âŒ Ù„Ø§ | âœ… Ù†Ø¹Ù… (Spatie/Custom) |
| **Access Control** | Ownership-based | Permission-based |
| **ÙŠÙ…ÙƒÙ†Ù‡ Ø±Ø¤ÙŠØ©** | Ù…ÙˆØ§Ø±Ø¯Ù‡ ÙÙ‚Ø· | ÙƒÙ„ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ (Ø­Ø³Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©) |
| **Stateless** | âœ… Ù†Ø¹Ù… | âŒ Ù„Ø§ (Session-based) |

---

## ï¸ **Ø£Ø®Ø·Ø§Ø¡ Ø´Ø§Ø¦Ø¹Ø© | Common Mistakes**

### ** Ø®Ø·Ø£ 1: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ†**

```php
// âŒ Ø®Ø·Ø£
Schema::create('users', function (Blueprint $table) {
    $table->user_type ENUM('customer', 'admin');  // Ù„Ø§ ØªÙØ¹Ù„ Ù‡Ø°Ø§!
});

// âœ… ØµØ­ÙŠØ­ - Ø¬Ø¯Ø§ÙˆÙ„ Ù…Ù†ÙØµÙ„Ø©
Schema::create('customers', function (Blueprint $table) { ... });
Schema::create('admin_users', function (Blueprint $table) { ... });
```

---

### ** Ø®Ø·Ø£ 2: Ø¥Ø¹Ø·Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø£Ø¯ÙˆØ§Ø±**

```php
// âŒ Ø®Ø·Ø£
$customer = Customer::create([...]);
$customer->assignRole('customer');  // Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù„Ø§ ÙŠØ³ØªØ®Ø¯Ù…ÙˆÙ† roles!

// âœ… ØµØ­ÙŠØ­ - Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù„Ø§ ÙŠØ­ØªØ§Ø¬ÙˆÙ† roles
$customer = Customer::create([
    'name' => 'Ø£Ø­Ù…Ø¯',
    'email' => 'ahmed@example.com',
    // ÙÙ‚Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
]);
```

---

### ** Ø®Ø·Ø£ 3: Ø§Ø³ØªØ®Ø¯Ø§Ù… API authentication Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ†**

```php
// âŒ Ø®Ø·Ø£ - Admin Panel ÙŠØ³ØªØ®Ø¯Ù… Sessions Ù„ÙŠØ³ Tokens
Route::middleware(['auth:sanctum'])->group(function () {
    Route::get('/admin/orders', ...);  // Ø®Ø·Ø£!
});

// âœ… ØµØ­ÙŠØ­ - Admin Panel ÙŠØ³ØªØ®Ø¯Ù… Session-based auth
Route::middleware(['auth:web'])->group(function () {
    Route::get('/admin/orders', ...);
});
```

---

### ** Ø®Ø·Ø£ 4: Ø¯Ù…Ø¬ API Controllers Ù…Ø¹ Admin Controllers**

```php
// âŒ Ø®Ø·Ø£ - Controller ÙˆØ§Ø­Ø¯ Ù„Ù„Ø§Ø«Ù†ÙŠÙ†
class OrderController extends Controller
{
    public function index() {
        // Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø£Ù… Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ†ØŸ ØºÙŠØ± ÙˆØ§Ø¶Ø­!
    }
}

// âœ… ØµØ­ÙŠØ­ - Controllers Ù…Ù†ÙØµÙ„Ø©
namespace App\Http\Controllers\API;
class OrderController extends Controller { ... }  // Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡

namespace App\Http\Controllers\Admin;
class OrderController extends Controller { ... }  // Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ†
```

---

## **Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ© | Reference Files**

### **Ù„ÙÙ‡Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡:**

- `01_Auth_Strategies.md` - Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
- `02_JWT_Implementation.md` - ØªÙ†ÙÙŠØ° JWT/Sanctum

### **Ù„ÙÙ‡Ù… RBAC Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ†:**

- `03_RBAC_Permissions.md` - Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ† ÙÙ‚Ø·)

---

## **Checklist Ø§Ù„ØªÙ†ÙÙŠØ° | Implementation Checklist**

### **Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ (Customer API):**

- [ ] Ø¬Ø¯ÙˆÙ„ `customers` Ù…Ù†ÙØµÙ„
- [ ] Ù…ÙˆØ¯ÙŠÙ„ `Customer` Ù…Ø¹ `HasApiTokens`
- [ ] Sanctum authentication Ù…Ø«Ø¨Øª
- [ ] Authentication guard: `sanctum`
- [ ] API Controllers ÙÙŠ `app/Http/Controllers/API/`
- [ ] Customer registration endpoint (`POST /api/v1/auth/register`)
- [ ] Customer login endpoint (`POST /api/v1/auth/login`)
- [ ] Routes ÙÙŠ `routes/api.php` Ù…Ø¹ prefix `/api/v1/*`
- [ ] Policies Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù„ÙƒÙŠØ©
- [ ] API Resources Ù„Ù„Ù€JSON responses
- [ ] âŒ **Ù„Ø§** Ø¬Ø¯Ø§ÙˆÙ„ roles/permissions Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡
- [ ] âŒ **Ù„Ø§** middleware Ù„Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙÙŠ routes Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
- [ ] âŒ **Ù„Ø§** session authentication Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡

### **Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ† (Admin Panel):**

- [ ] Ø¬Ø¯ÙˆÙ„ `admin_users` Ù…Ù†ÙØµÙ„
- [ ] Ù…ÙˆØ¯ÙŠÙ„ `AdminUser` Ù…Ø¹ `HasRoles`
- [ ] Ø¬Ø¯Ø§ÙˆÙ„ RBAC (roles, permissions, admin_user_role, permission_role)
- [ ] Authentication guard: `web` (Session-based)
- [ ] Admin Controllers ÙÙŠ `app/Http/Controllers/Admin/`
- [ ] Admin login page (`GET /admin/login`)
- [ ] Admin login action (`POST /admin/login`)
- [ ] Routes ÙÙŠ `routes/web.php` Ù…Ø¹ prefix `/admin/*`
- [ ] Middleware `auth:web` Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ†
- [ ] Middleware Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (`can:permission`)
- [ ] Seeders Ù„Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
- [ ] Blade views Ø£Ùˆ Inertia pages
- [ ] âœ… RBAC system ÙƒØ§Ù…Ù„ (Spatie Permission Ø£Ùˆ custom)
- [ ] âŒ **Ù„Ø§** API tokens Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ† (ÙŠØ³ØªØ®Ø¯Ù…ÙˆÙ† Sessions)

### **Ø§Ù„Ù…Ø´ØªØ±ÙƒØ© (Shared):**

- [ ] Models Ù„Ù„Ù…ÙˆØ§Ø±Ø¯ (Product, Order, etc.)
- [ ] Services Ù„Ù„Ù€Business Logic
- [ ] Repositories (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
- [ ] Events & Listeners
- [ ] Jobs & Queues
- [ ] Notifications

---

## **Ø§Ù„Ø®Ù„Ø§ØµØ© | Conclusion**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„ØµØ­ÙŠØ­Ø©                       â”‚
â”‚                   The Correct Architecture                       â”‚
â”‚                                                                   â”‚
â”‚  ğŸ“± Customers (API)          ğŸ–¥ï¸ Admin Panel (Web)               â”‚
â”‚  â”œâ”€ Table: customers         â”œâ”€ Table: admin_users              â”‚
â”‚  â”œâ”€ Guard: sanctum           â”œâ”€ Guard: web (session)            â”‚
â”‚  â”œâ”€ Token-based              â”œâ”€ Session-based                   â”‚
â”‚  â”œâ”€ Controllers: API/*       â”œâ”€ Controllers: Admin/*            â”‚
â”‚  â”œâ”€ Routes: api.php          â”œâ”€ Routes: web.php                 â”‚
â”‚  â”œâ”€ Response: JSON           â”œâ”€ Response: Views                 â”‚
â”‚  â”œâ”€ âŒ NO RBAC               â”œâ”€ âœ… WITH RBAC                    â”‚
â”‚  â””â”€ Ownership-based          â””â”€ Permission-based                â”‚
â”‚                                                                   â”‚
â”‚  âš ï¸ Ø¬Ø¯Ø§ÙˆÙ„ Ù…Ù†ÙØµÙ„Ø©ØŒ Controllers Ù…Ù†ÙØµÙ„Ø©ØŒ Auth Ù…Ù†ÙØµÙ„              â”‚
â”‚  âš ï¸ Separate tables, controllers, authentication                â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Ø§Ù„Ù…Ø¨Ø§Ø¯Ø¦ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© | Core Principles:**

**1. Ø§Ù„ÙØµÙ„ Ø§Ù„ÙƒØ§Ù…Ù„ | Complete Separation:**

- Ø¬Ø¯Ø§ÙˆÙ„ Ù…Ù†ÙØµÙ„Ø© (`customers` vs `admin_users`)
- Models Ù…Ù†ÙØµÙ„Ø© (`Customer` vs `AdminUser`)
- Controllers Ù…Ù†ÙØµÙ„Ø© (`API\*` vs `Admin\*`)
- Authentication Ù…Ù†ÙØµÙ„ (Tokens vs Sessions)
- Routes Ù…Ù†ÙØµÙ„Ø© (`api.php` vs `web.php`)

**2. Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø´ØªØ±ÙƒØ© | Shared Resources:**

- Models Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Product, Order, Category)
- Services Ù„Ù„Ù€Business Logic
- Database tables Ù„Ù„Ù…ÙˆØ§Ø±Ø¯
- Events, Jobs, Notifications

**3. Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙˆØµÙˆÙ„ | Access Control:**

- **Customers**: Ownership-based (Ù‡Ù„ Ø§Ù„Ù…ÙˆØ±Ø¯ Ù„Ù‡ØŸ)
- **Admin Users**: Permission-based (Ù‡Ù„ Ù„Ø¯ÙŠÙ‡ ØµÙ„Ø§Ø­ÙŠØ©ØŸ)

---

### **Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© | The Golden Rule:**

```php
// âŒ Ù„Ø§ ØªÙØ¹Ù„ Ù‡Ø°Ø§ NEVER:
- Ø¬Ø¯ÙˆÙ„ users ÙˆØ§Ø­Ø¯ Ù„ÙƒÙ„Ø§ Ø§Ù„Ù†ÙˆØ¹ÙŠÙ†
- Controllers Ù…Ø´ØªØ±ÙƒØ©
- Ø®Ù„Ø· API authentication Ù…Ø¹ Session authentication
- Ø¥Ø¹Ø·Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ roles/permissions

// âœ… Ø§ÙØ¹Ù„ Ù‡Ø°Ø§ ALWAYS:
- Ø¬Ø¯Ø§ÙˆÙ„ Ù…Ù†ÙØµÙ„Ø© (customers, admin_users)
- Controllers Ù…Ù†ÙØµÙ„Ø© (API\*, Admin\*)
- Authentication Ù…Ù†ÙØµÙ„ (sanctum, web)
- RBAC Ù„Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ† ÙÙ‚Ø·
```

---

### **Ù…ØªÙ‰ ØªÙ‚Ø±Ø£ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„ÙØŸ | When to Read This?**

âš ï¸ **Ø§Ù‚Ø±Ø£ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù‚Ø¨Ù„:**

- Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·ÙˆÙŠØ±
- ØªØµÙ…ÙŠÙ… Database Schema
- Ø¥Ù†Ø´Ø§Ø¡ Authentication System
- ÙƒØªØ§Ø¨Ø© Controllers
- ØªØ·Ø¨ÙŠÙ‚ RBAC System

---

**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« | Last Updated**: October 20, 2025  
**Ø§Ù„Ø¥ØµØ¯Ø§Ø± | Version**: 2.0
